---
title:      "Our new paper + better visualization with ggplotly"
date:       2018-03-28T21:13:14-05:00
summary:    Our new paper is out in Systematic Biology, and I have prepared these plots using ggplotly to make the visualization easier"
categories: ["paper"]
tags:       ["english", "paper", "systematic biology", "graphs", "visualization", "R"]
comments:   true
---

```{r, echo = FALSE, warning = FALSE}
#install.packages("plotly", quiet = TRUE)
library("ggplot2", verbose = FALSE)
library("plotly", verbose = FALSE, warn.conflicts = FALSE)
library("cowplot", verbose = FALSE, warn.conflicts = FALSE)
bvdc.rpanda <- read.csv("../../data/bvardcst_rpanda.csv")
bvdc.bamm <- read.csv("../../data/bvardcst_bamm.csv")
bcdv.rpanda <- read.csv("../../data/bcstdvar_rpanda.csv")
bcdv.bamm <- read.csv("../../data/bcstdvar_bamm.csv")
model.colors <- c("#ba495b", "#b0923b", "#56ae6c", "#8960b3")
model.names <- function(x){
    gsub("bvardvar", "BOTHvar", gsub("bvardcst", "SPvar", gsub("bcstdvar", "EXvar", gsub("bcstdcst", "BOTHcst", x))))
    }
bvdc.rpanda[, c("models80", "models.50", "models.20", "models.s20")] <- lapply(bvdc.rpanda[, c("models80", "models.50", "models.20", "models.s20")], model.names)
bvdc.rpanda[, c("models80", "models.50", "models.20", "models.s20")] <- lapply(bvdc.rpanda[, c("models80", "models.50", "models.20", "models.s20")], factor, levels = c("BOTHcst", "EXvar", "SPvar", "BOTHvar"))
bcdv.rpanda[, c("models.80", "models.50", "models.20", "models.s20")] <- lapply(bcdv.rpanda[, c("models.80", "models.50", "models.20", "models.s20")], model.names)
bcdv.rpanda[, c("models.80", "models.50", "models.20", "models.s20")] <- lapply(bcdv.rpanda[, c("models.80", "models.50", "models.20", "models.s20")], factor, levels = c("BOTHcst", "EXvar", "SPvar", "BOTHvar"))
```

I am glad to announce that our latest paper is available! In this study, we compared the performance of BAMM and RPANDA when estimating macroevolutionary rates for clades in decline. We had a hard time with the figures because there were too many points in each graph. Thus, I decided to use ggplot2 + plotly to provide an interactive, better visualization of the main figures.

# Parameter Space

 
# Fitting

### BVARDCST

#### 20% loss

##### RPANDA

```{r, echo = FALSE, warning = FALSE, message = FALSE}
rpanda.bvdc.lambda.20left <-
    ggplot(data = subset(bvdc.rpanda, ntip.80 > 2), aes(x = lambda.final.sim.80, y = abs(lambda.80))) +
    geom_point(aes(colour = models80), size = 2, alpha = 0.5) +
    geom_abline(intercept = 0, slope = 1, colour = "red") +
    scale_colour_manual(values = model.colors) +
    theme(legend.position = "bottom" ) +
    labs(x = "Simulated lambda", y = "Estimated lambda", colour = "Models") +
    ggtitle("RPANDA") +
    xlim(0,2) +
    ylim(0,2) +
    scale_radius()

ggplotly(rpanda.bvdc.lambda.20left)
      ```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
rpanda.bcdv.lambda.20left <-
    ggplot(data = subset(bcdv.rpanda, ntip80 > 2), aes(x = lambda.sim, y = abs(lambda.80))) +
    geom_point(aes(colour = models.80), size = 2, alpha = 0.5) +
    geom_abline(intercept = 0, slope = 1, colour = "red") +
    scale_colour_manual(values = model.colors) +
    theme(legend.position = "bottom" ) +
    labs(x = "Simulated lambda", y = "Estimated lambda", colour = "Models") +
    ggtitle("RPANDA") +
    scale_radius()

ggplotly(rpanda.bcdv.lambda.20left)
      ```

